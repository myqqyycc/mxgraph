<!--
  Copyright (c) 2006-2013, JGraph Ltd

  Codec example for mxGraph. This example demonstrates dynamically
  creating a graph from XML and encoding the model into XML, as well
  as changing the default style for edges in-place.
-->
<html>
<head>
    <title>Codec example for mxGraph</title>

    <!-- Sets the basepath for the library if not in same directory -->
    <script type="text/javascript">
        mxBasePath = '/page/src';
    </script>

    <!-- Loads and initializes the library -->
    <script type="text/javascript" src="/page/src/js/mxClient.js"></script>
    <script type="text/javascript" src="js/Graph.js"></script>
    <script type="text/javascript" src="js/Shapes.js"></script>
    <!-- Example code -->
    <script type="text/javascript">
        // Program starts here. Creates a sample graph in the
        // DOM node with the specified ID. This function is invoked
        // from the onLoad event handler of the document (see below).
        var graph;
        function main(container)
        {
            if (mxClient.isBrowserSupported())
            {
                var xml = '<mxGraphModel dx="1634" dy="516" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.65;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="2" target="3"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="2" value="" style="triangle;whiteSpace=wrap;html=1;" vertex="1" parent="1"><mxGeometry x="140" y="240" width="60" height="80" as="geometry"/></mxCell><mxCell id="3" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1"><mxGeometry x="520" y="360" width="80" height="80" as="geometry"/></mxCell></root></mxGraphModel>';
                var xmlDocument = mxUtils.parseXml(xml);
                var decoder = new mxCodec(xmlDocument);
                var node = xmlDocument.documentElement;

                graph = new mxGraph(container);

//                graph.insertEdge(parent, null, '', null, null, 'edgeStyle=orthogonalEdgeStyle;');

                graph.centerZoom = false;
                graph.setTooltips(false);
                graph.setEnabled(false);

                // Changes the default style for edges "in-place"
                var style = graph.getStylesheet().getDefaultEdgeStyle();
//                style[mxConstants.STYLE_EDGE] = mxEdgeStyle.ElbowConnector;
                style[mxConstants.STYLE_ROUNDED] = false;//圆角连线
                style[mxConstants.STYLE_EDGE] = 'orthogonalEdgeStyle';
                style[mxConstants.STYLE_EDGE] = mxEdgeStyle.TopToBottom;
                style[mxConstants.PERIMETER_TRIANGLE] = mxPerimeter.TrianglePerimeter;
//                triangle
                // Enables panning with left mouse button
                graph.panningHandler.useLeftButtonForPanning = true;
                graph.panningHandler.ignoreCell = true;
                graph.container.style.cursor = 'move';
                graph.setPanning(true);


                decoder.decode(node, graph.getModel());
                graph.resizeContainer = false;

                // Adds zoom buttons in top, left corner
                var buttons = document.createElement('div');
                buttons.style.position = 'absolute';
                buttons.style.overflow = 'visible';

                var bs = graph.getBorderSizes();
                buttons.style.top = (container.offsetTop + bs.y) + 'px';
                buttons.style.left = (container.offsetLeft + bs.x) + 'px';

                var left = 0;
                var bw = 16;
                var bh = 16;

                if (mxClient.IS_QUIRKS)
                {
                    bw -= 1;
                    bh -= 1;
                }

                function addButton(label, funct)
                {
                    var btn = document.createElement('div');
                    mxUtils.write(btn, label);
                    btn.style.position = 'absolute';
                    btn.style.backgroundColor = 'transparent';
                    btn.style.border = '1px solid gray';
                    btn.style.textAlign = 'center';
                    btn.style.fontSize = '10px';
                    btn.style.cursor = 'hand';
                    btn.style.width = bw + 'px';
                    btn.style.height = bh + 'px';
                    btn.style.left = left + 'px';
                    btn.style.top = '0px';

                    mxEvent.addListener(btn, 'click', function(evt)
                    {
                        funct();
                        mxEvent.consume(evt);
                    });

                    left += bw;

                    buttons.appendChild(btn);
                };

                addButton('+', function()
                {
                    graph.zoomIn();
                });

                addButton('-', function()
                {
                    graph.zoomOut();
                });

                if (container.nextSibling != null)
                {
                    container.parentNode.insertBefore(buttons, container.nextSibling);
                }
                else
                {
                    container.appendChild(buttons);
                }

            }
        };
    </script>
</head>
<body>
<div id="gggg" style="width: 100%;height: 100%"></div>
</body>
<script type="text/javascript">

    main(document.getElementById("gggg"));

</script>
</html>
